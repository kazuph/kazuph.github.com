<!doctype html>  
<html lang="ja">

  <head>
    <meta charset="utf-8">

    <title>みんなでProjectEuler<br />in Ruby</title>

    <meta name="description" content="A framework for easily creating beautiful presentations using HTML">
    <meta name="author" content="kazuph">

    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

    <link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic' rel='stylesheet' type='text/css'>

    <link rel="stylesheet" href="css/reveal.css">
    <!-- <link rel="stylesheet" href="css/theme/default.css" id="theme"> -->
    <!-- ここでデザインの変更ができる-->
    <!-- <link rel="stylesheet" href="css/theme/blue.css" id="theme"> -->
    <!-- <link rel="stylesheet" href="css/theme/serif.css" id="theme"> -->
    <link rel="stylesheet" href="css/theme/sky.css" id="theme">
    <!-- <link rel="stylesheet" href="css/theme/simple.css" id="theme"> -->
    <!-- <link rel="stylesheet" href="css/theme/beige.css" id="theme"> -->

    <!-- For syntax highlighting -->
    <link rel="stylesheet" href="lib/css/zenburn.css">

    <!-- If the query includes 'print-pdf', use the PDF print sheet -->
    <script>
      document.write( '<link rel="stylesheet" href="css/print/' + ( window.location.search.match( /print-pdf/gi ) ? 'pdf' : 'paper' ) + '.css" type="text/css" media="print">' );
      </script>

      <!--[if lt IE 9]>
      <script src="lib/js/html5shiv.js"></script>
      <![endif]-->
    </head>

    <body>

      <div class="reveal">

        <!-- Used to fade in a background when a specific slide state is reached -->
        <div class="state-background"></div>

        <!-- Any section element inside of this container is displayed as a slide -->
        <div class="slides">
          <section>
<h1>みんなでProjectEuler<br />in Ruby</h1>

<p>@kazuph</p>

<p>2012/12/01</p>

</section><section>
<h4>自己紹介</h4>

</section><section>
<h3><img style="width:15%;margin-top:-100px;" src="./img/praykazuph.png" alt="pray_kazuph"><br />かずふ<br />kazuph</h3>

</section><section>
<h3>2年目エンジニア</h3>

</section><section>
<h2>Vimの記事を書いたり</h2>

<p><img src="img/hatebu.png" alt="hatebu" title="hagebu"></p>

</section><section>
<h2>vimrc読書会</h2>

<p>に行ってdisられてきたりしている
<img src="img/vim4.png" alt="vim4" title="vim4"></p>

</section><section>
<h3>Vimが大好きな<br />スマフォエンジニアです！</h3>

</section><section>
<h3>続きは懇親会で！</h3>

</section><section>
<h3>突然ですが皆さん</h3>

</section><section>
<h3>ProjectEulerって<br />知ってますか？</h3>

</section><section>
<h3>しーん</h3>

</section><section>
<h2>ProjectEulerとは</h2>

<blockquote>
<p>挑戦的な数学/コンピュータのプログラミング問題集サイト。</p>
</blockquote>

<p>Link : <a href="http://projecteuler.net">ProjectEuler</a></p>

</section><section>
<h3>ふーん</h3>

</section><section>
<h3>じゃあ</h3>

</section><section>
<h2>この「お姉さん」は知ってますか！？</h2>

<p><img src="./img/oneesan.jpg" alt="oneesan"></p>

<p><a href="http://www.youtube.com/watch?v=Q4gTV4r0zRs">出展：『フカシギの数え方』 おねえさんといっしょ！ みんなで数えてみよう！ </a></p>

</section><section>
<h3>( ･`ω･´)/</h3>

</section><section>
<h3>つまるところ</h3>

</section><section>
<h3>ProjectEulerとは</h3>

</section><section>
<h2>↓な問題をたくさん解くサイト</h2>

<p><img src="./img/kazoeruna.jpg" alt="oneesan"></p>

</section><section>
<h3>こんな問題が<br />400問以上</h3>

</section><section>
<h3>お姉さんに見せたら<br />大変なことに！？</h3>

</section><section>
<h3>これ以上お姉さんに数えさせちゃいけない！！</h3>

</section><section>
<h2>こんなことや</h2>

<p><img src="./img/tomenaide.jpg" alt="tomenaide"></p>

</section><section>
<h2>こんなことになってしまう前に！</h2>

<p><img src="./img/nesan1.png" alt="nesan1"></p>

</section><section>
<h3>きれいなお姉さんは<br />救いたいですか？</h3>

</section><section>
<h1>みんなでProjectEuler<br />in Ruby</h1>

<p>@kazuph</p>

<p>2012/12/01</p>

</section><section>
<h3>もとい</h3>

</section><section>
<h1>Rubyでお姉さん<br />（複数人）<br />を救った話</h1>

<p>@kazuph</p>

<p>2012/12/01</p>

</section><section>
<h2>はい</h2>

<p>と言うことで、ここからはまったく「お姉さん」とは関係なく、会社のみんなでProjectEulerを解いてみた話をします。</p>

</section><section>
<h2>Eulerの始まり</h2>

<p>とある部長がSkypeで問題１を<br />出題したのが発端
<div class="fragment"> ↓</div>
<div class="fragment"> みんなが解答をSkypeであげまくる</div>
<div class="fragment"> ↓</div>
<div class="fragment"> みんなが解いたソースを自分の<br />リポジトリに上げ始めた</div>
<div class="fragment"> ↓</div>
<div class="fragment"> Facebookグループで「解いた！」宣言<br />→レビュー</div></p>

</section><section>
<h2>他力本願</h2>

<p>めんどくさいことはJenkinsさんにお願い！</p>

<p><img src="./img/fb_jenkins.jpg" alt="fb_jenkis"></p>

</section><section>
<h3>翌週には完成してました(^q^)</h3>

</section><section>
<h2>僕らのつくったEulerSystem</h2>

<ul>
<li>githubにpushするだけの簡単操作</li>
<li>コミットすると実行(結果|時間)を更新</li>
<li>問題ごとに実行速度順にランキング</li>
<li>言語は一応Ruby縛り</li>
</ul>

</section><section>
<h2>こんなん</h2>

<p><img src="./img/pjeulercom.png" alt="pjeuler"></p>

</section><section>
<h3>そんな感じで楽しい<br />「ぷろおい！」生活が<br />始まる</h3>

</section><section>
<h4>Problem 1</h4>

</section><section>
<h2>Problem 1</h2>

<blockquote>
<p>1000 未満の 3 か 5 の倍数になっている<br />数字の合計を求めよ.</p>
</blockquote>

<p><a href="http://odz.sakura.ne.jp/projecteuler/index.php?cmd=read&amp;page=Problem%201">出展：ProjectEuler 問題1</a></p>

</section><section>
<h3>当時のSkypeでの解答</h3>

</section><section>
<h2>某春◯さんの解答</h2>

<pre><code>#!/usr/bin/env ruby
# encoding: UTF-8

total = 0
(1..1000).each do |num|
  if num % 3 == 0 || num % 5 == 0
    total += num
  end
end
p total
</code></pre>

</section><section>
<h3>※ここからのコードは<br />時間がないので<br />雰囲気だけ味わってね☆彡</h3>

</section><section>
<h2>PHPerさんの解答</h2>

<pre><code>&lt;?php
//3の倍数
$total = 0;
for($n = 1 ; 3 * $n &lt; 1000 ; $n++){
    $total += 3 * $n;
}

//5の倍数
for($n = 1 ; 5 * $n &lt; 1000 ; $n++){
    //3の倍数は除く
    if( $n%3 != 0 )$total += 5 * $n;
}

echo $total;
</code></pre>

</section><section>
<h2>Perlerさんの解答</h2>

<pre><code>my $res = 0;
map { $res += ( $_ % 3 &amp;&amp; $_ % 5 ) ? 0 : $_ } 1..999;
say $res;
</code></pre>

</section><section>
<h2>ワンライナー</h2>

<p>春◯さん②</p>

<pre><code>$ perl -e &#39;$a; for(1..1000){unless($_%3&amp;&amp;$_%5){$a+=$_}};print &quot;$a&quot;&#39;
</code></pre>

<p>僕</p>

<pre><code>$ perl -le &#39;print eval(join &quot;+&quot;,(grep{!($_%3)||!($_%5)}1..(1e3-1)))&#39;
</code></pre>

<p>PHPerの方②</p>

<pre><code>$sum = 0;for($i=0;$i&lt;1000;$i++)if($i%3===0||$i%5===0) $sum+=$i;
</code></pre>

<p>Rubyistの人</p>

<pre><code>((0...1000).step(3).to_a | (0...1000).step(5).to_a).inject(0){|s, i|s+=i}
</code></pre>

</section><section>
<h2>なぜかPerl6</h2>

<pre><code>perl6 -e &#39;say [+] (1..999).grep({!($_%3)||!($_%5)})&#39;
</code></pre>

</section><section>
<h3>人によって書き方が<br />たくさんある！</h3>

</section><section>
<h3>こんな感じで社内で<br />盛り上がりました！</h3>

</section><section>
<h3>更にEuelr Systemが<br />できてからの投稿</h3>

</section><section>
<h2>ここからはスピードとの戦いです</h2>

<pre><code>p (1..999).select {|n| n % 3 == 0 || n % 5 == 0}.inject(&amp;:+)
</code></pre>

</section><section>
<h2>ループはeachが速い</h2>

<pre><code>total = 0
(1..999).each{|n| total += n if n % 3 == 0 || n % 5 == 0}
p total
</code></pre>

</section><section>
<h2>CTOのズルい一投</h2>

<p>数学的に解く</p>

<pre><code>m = 1000; a1 = 3; a2 = 5
m = m - 1; a3 = a1 * a2; 
b1 = (m / a1).to_i; b2 = (m / a2).to_i; b3 = (m / a3).to_i
p (b1 * (b1 + 1) * a1 + b2 * (b2 + 1) * a2 - b3 * (b3 + 1) * a3) / 2
</code></pre>

</section><section>
<h3>ループしたら負け</h3>

</section><section>
<h3>ならば！</h3>

</section><section>
<h2>演算コストを極める</h2>

<p>四則演算「+」「-」「*」「/」を減らす</p>

<pre><code>p( (999.div(3) * (3 + 999) + 999.div(5) * (5 + 995) - 999.div(15) * (15 + 990)) / 2)

</code></pre>

</section><section>
<h2>Win!</h2>

<pre><code>m = 1000; a1 = 3; a2 = 5
m = m - 1; a3 = a1 * a2; b1 = (m / a1).to_i; b2 = (m / a2).to_i; b3 = (m / a3).to_i
p (b1 * (b1 + 1) * a1 + b2 * (b2 + 1) * a2 - b3 * (b3 + 1) * a3) / 2

</code></pre>

<p>Time: 0.12 msec</p>

<pre><code>p( (999.div(3) * (3 + 999) + 999.div(5) * (5 + 995) - 999.div(15) * (15 + 990)) / 2)

</code></pre>

<p>Time: 0.05 msec</p>

</section><section>
<h4>Problem 7</h4>

</section><section>
<h2>Problem 7</h2>

<blockquote>
<p>10001 番目の素数を求めよ.</p>
</blockquote>

<p><a href="http://odz.sakura.ne.jp/projecteuler/index.php?cmd=read&amp;page=Problem%207">出展：ProjectEuler 問題7</a></p>

</section><section>
<h3>素数の問題</h3>

</section><section>
<h3>はい、そうです</h3>

</section><section>
<h3>require &#39;prime&#39;が<br />ありますね</h3>

<p><center>
(or require &#39;mathn&#39;)
</center></p>

</section><section>
<h2>require &#39;prime&#39;</h2>

<p>素数の判定をしてくれる</p>

<pre><code>require &#39;prime&#39;

i = 2
j = 1

loop do
    if i.prime?
        j += 1
    end
    if j &gt; 10001
        break
    end
    i += 1
end
puts i
</code></pre>

</section><section>
<h2>require &#39;mathn&#39;</h2>

<p>(こっちが推奨？)</p>

<pre><code>require &#39;mathn&#39;
i = 1
cnt = 0
while i += 1
  if Prime.instance.prime?(i)
    cnt += 1
    if cnt == 10001
      break
    end
  end
end
p i
</code></pre>

</section><section>
<h3>これでは味気なさすぎる</h3>

</section><section>
<h2>6k±1フィルタ</h2>

<p>6の倍数±1以外は素数でないので省く</p>

<pre><code>#!/usr/bin/env ruby
# coding : utf-8
require &#39;prime&#39;
max = 10001
primes = [2, 3, 5]
n=0
loop do
  break if primes.size &gt; 10001
  n+=1
  prime = 6*n+1
  primes &lt;&lt; prime if prime.prime?
  prime +=4
  primes &lt;&lt; prime if prime.prime?
end
p primes[max-1]
</code></pre>

</section><section>
<h3>アルゴリズムを工夫<br />してこそのEuler</h3>

</section><section>
<h3>そしてさらに高みを<br />求めるのもEuler</h3>

</section><section>
<h3>require &#39;prime&#39;？</h3>

</section><section>
<h3>貧弱、貧弱！</h3>

</section><section>
<h2>アルゴリズムを極める</h2>

<p>素数の判定を自前で実装で</p>

<pre><code>max = 10001
def prime?(num,  ary)
  ary.each do |n|
    break if n * n  &gt; num
    return false if num % n == 0
  end
  return true
end
n = 0
prime_ary = [2,  3,  5]
while  prime_ary.count &lt; max
  n += 1
  prime = 6 * n + 1
  prime_ary.push(prime) if prime?(prime,  prime_ary)
  prime += 4
  prime_ary.push(prime) if prime?(prime,  prime_ary)
end
p prime_ary[-1]
</code></pre>

</section><section>
<h2>ベンチマーク結果</h2>

<table><thead>
<tr>
<th>手法</th>
<th>実行時間</th>
</tr>
</thead><tbody>
<tr>
<td>prime</td>
<td>3575.42 msec</td>
</tr>
<tr>
<td>mathn</td>
<td>3445.56 msec</td>
</tr>
<tr>
<td>6k±1</td>
<td>2767.65 msec</td>
</tr>
<tr>
<td>自前で全部実装</td>
<td>223.41 msec</td>
</tr>
</tbody></table>

<p>なんと10倍速い！</p>

</section><section>
<h3>アルゴリズムの神秘</h3>

</section><section>
<h3>オイラーには素数を<br />計算する問題が多い</h3>

</section><section>
<h3>つまりは、</h3>

</section><section>
<h3>素数を制する者が</h3>

</section><section>
<h3>オイラーを制す！！</h3>

</section><section>
<h3>そんなこんなで</h3>

</section><section>
<h3>社内で熱いバトルを<br />繰り広げています^^</h3>

</section><section>
<h3>そして</h3>

</section><section>
<h3>社内の火種は</h3>

</section><section>
<h3>日本中に飛び火</h3>

</section><section>
<h2>素数戦争勃発！</h2>

<p>YAPC × CodeIQ ×ガイアックス</p>

<p>オンラインで素数問題の解答を投稿</p>

<p><img src="img/bu.png" alt="bu" title="bu"></p>

</section><section>
<h3>ﾄﾞﾔｧ!m9( ･`ω･´)</h3>

</section><section>
<h3>まとめ</h3>

</section><section>
<h2>やって良かったこと</h2>

<ul>
<li>パフォーマンスを意識してプログラミングをできるようになった</li>
<li>全員がRubyでやったので言葉が通じるようになった</li>
<li>みんなで「同じ問題」を解いているので、レビューがとてもやり易い</li>
<li>人や自分の癖がわかるようになった</li>
</ul>

</section><section>
<h2>今後の課題</h2>

<ul>
<li>全くオブジェクト指向が身についてない</li>
<li>Rubyのワンライナーがキメると気持ちよすぎて逆にキモい（明らかに自分のせい</li>
<li>TDD導入など</li>
</ul>

</section><section>
<h3>最後に</h3>

</section><section>
<h3>みんなと「競争」って<br />実は楽しい！</h3>

</section><section>
<h2>ISUCON然り</h2>

<p><img src="img/isucon.png" alt="isucon" title="isucon"></p>

</section><section>
<h3>みなさんも会社でオイラーを<br />やって見てください</h3>

</section><section>
<h3>Enjoy Your Euler Life!</h3>

</section><section>
<h3>Thank you!</h3>
</section>
        </div>

        <!-- The navigational controls UI -->
        <aside class="controls">
          <a class="left" href="#">&#x25C4;</a>
          <a class="right" href="#">&#x25BA;</a>
          <a class="up" href="#">&#x25B2;</a>
          <a class="down" href="#">&#x25BC;</a>
        </aside>

        <!-- Presentation progress bar -->
        <div class="progress"><span></span></div>

      </div>

      <script src="lib/js/head.min.js"></script>
      <script src="js/reveal.min.js"></script>

      <script>

        // Full list of configuration options available here:
        // https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({
controls: true,
progress: true,
history: true,

theme: Reveal.getQueryHash().theme || 'blue', // available themes are in /css/theme
transition: Reveal.getQueryHash().transition || 'blue', // default/cube/page/concave/linear(2d)

// Optional libraries used to extend on reveal.js
dependencies: [
{ src: 'lib/js/highlight.js', async: true, callback: function() { window.hljs.initHighlightingOnLoad(); } },
{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
{ src: 'lib/js/showdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
{ src: 'lib/js/data-markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
{ src: '/socket.io/socket.io.js', async: true, condition: function() { return window.location.host === 'localhost:1947'; } },
{ src: 'plugin/speakernotes/client.js', async: true, condition: function() { return window.location.host === 'localhost:1947'; } },
]
});

</script>

  </body>
</html>
